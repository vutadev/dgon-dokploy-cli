# Dokploy API & CLI Research Report
**Date:** 2026-01-13 | **Status:** Complete

## Executive Summary
Dokploy is an open-source, self-hosted PaaS alternative to Vercel/Netlify/Heroku with comprehensive REST API and official CLI. Both use token-based authentication via API keys. No documented rate limits found in codebase.

---

## API Architecture

### Base URL & Access
- **Default:** `http://localhost:3000/api` (self-hosted)
- **Swagger UI:** `your-vps-ip:3000/swagger` (admin-only, authenticated)
- **Port:** 3000 by default

### Authentication
**Method:** API Key (JWT-based via Better Auth library)
- **Header:** `x-api-key: <YOUR-API-KEY>`
- **Generation:** Dashboard → Settings → Profile → API/CLI Section → Generate Token
- **Scope:** Admin grants tokens; users can request token creation permissions
- **Expiry:** Tokens never expire by default
- **Storage:** CLI auto-generates `config.json` with token & server URL

**Implementation Details:**
- Uses Better Auth framework with `apiKey()` plugin
- Tokens verified via `api.verifyApiKey()` before request processing
- Fallback to session-based auth if no API key provided

---

## Key API Endpoints (40+ routers)

### Deployment & Applications
- `GET /deployment.all` — List deployments by app (`applicationId`)
- `GET /deployment.allByCompose` — Filter by Docker Compose (`composeId`)
- `GET /deployment.allByServer` — Filter by server (`serverId`)
- `GET /deployment.allByType` — Filter by type (app/compose/server/schedule/preview/backup)
- `POST /deployment.killProcess` — Terminate running deployment

**Application Management:**
- `/application.create`, `/application.update`, `/application.delete`
- `/application.deploy`, `/application.redeploy`, `/application.reload`
- `/application.stop`, `/application.start`
- `/application.stats` — CPU, memory, network monitoring

### Infrastructure
- **Databases:** `/mysql.*`, `/postgres.*`, `/mariadb.*`, `/mongo.*`, `/redis.*`
- **Domains & SSL:** `/domain.*`, `/certificate.*`
- **Compute:** `/server.*`, `/cluster.*`, `/docker.*`, `/destination.*`
- **Networking:** `/port.*`, `/redirects.*`, `/security.*`

### DevOps & Automation
- `/git-provider.*` — GitHub, GitLab, Gitea, Bitbucket integration
- `/preview-deployment.*` — PR deployment previews
- `/schedule.*` — Scheduled deployments/jobs
- `/volume-backups.*`, `/backup.*` — Data persistence
- `/mount.*` — Volume management

### System Management
- `/project.*` — Project CRUD & organization
- `/environment.*` — Environment variable management
- `/settings.*` — Server-wide configuration
- `/organization.*` — Multi-tenancy support
- `/admin.*` — Administrative operations

---

## Official CLI Capabilities

**Package:** `@dokploy/cli` (npm)
**Installation:** `npm install -g @dokploy/cli`

### Command Structure
```
dokploy authenticate           # Create/verify connection
dokploy project:list          # List projects
dokploy project:info          # Project details
dokploy app:create            # Deploy app
dokploy app:deploy            # Redeploy app
dokploy app:stop              # Stop app
dokploy app:delete            # Remove app
dokploy env pull <file>       # Download .env
dokploy env push <file>       # Upload .env
dokploy [db]:create           # Create DB (mysql/postgres/mongo/redis/mariadb)
```

### Auth Flow
1. `dokploy authenticate` — Prompts for API token & server URL
2. Stores config in `config.json` (auto-generated by Dokploy)
3. `dokploy verify` — Tests connection validity

---

## Architecture Insights

### Request Flow (from code analysis)
```
Request Headers: x-api-key
    ↓
validateRequest() in auth.ts
    ↓
api.verifyApiKey() → lookup in apikey table
    ↓
Resolve user + organization via better-auth
    ↓
Mock session created with activeOrganizationId
    ↓
Route handler executes with context
```

### Multi-Tenancy
- **Organizations:** One admin owns org, invites members
- **API Key Scope:** Tied to user + organization (metadata stored in JSON)
- **Authorization:** Role-based (owner/member) for service access
- **Default Org:** User's first org marked as default

---

## Comparative Analysis: Similar CLIs

| Feature | Dokploy | Vercel | Railway | Fly.io |
|---------|---------|--------|---------|--------|
| **Auth** | API Key (no expiry) | Token (24h expiry) | Token | Personal API tokens |
| **Self-Hosted** | ✅ Full | ✗ SaaS only | ✗ SaaS only | ✗ SaaS only |
| **CLI Package** | Official (@dokploy/cli) | Official (vercel) | Official (railway) | Official (flyctl) |
| **DB Support** | 5+ via API | Limited | Limited | PostgreSQL only |
| **Multi-Tenancy** | ✅ Yes (orgs) | Per-account | Per-team | Per-org |
| **Rate Limits** | Not documented | 10 req/sec | Unknown | Unknown |

---

## Known Gotchas & Limitations

1. **No Public Rate Limiting:** Codebase shows rate-limit schema fields but marked as TODO (commented out)
2. **Admin-Only API Access:** By default, only admins generate tokens; regular users can't access API
3. **No Token Expiry:** Security concern for long-lived self-hosted deployments
4. **Single Server Mode:** Self-hosted defaults to one server; Docker Swarm needed for scale
5. **Swagger Access:** Restricted to authenticated admins, not public API docs
6. **No Webhook Events:** Deployments lack event subscriptions (only polling available)

---

## Security Considerations

- Better Auth with bcrypt password hashing
- API keys stored in database with metadata (org context)
- Member role-based access control on services
- Email verification for cloud deployments
- Two-factor authentication support

---

## Sources & References

- [Dokploy API Docs](https://docs.dokploy.com/docs/api)
- [Dokploy CLI Docs](https://docs.dokploy.com/docs/cli)
- [Dokploy GitHub](https://github.com/Dokploy/dokploy) — 29k+ stars
- [CLI Package](https://github.com/Dokploy/cli) — Official implementation
- Source: Server auth implementation (`packages/server/src/lib/auth.ts`)

---

## Unresolved Questions

1. What is the actual rate limit enforcement? (schema present but not implemented)
2. Does Dokploy support webhook events for deployments?
3. Are there environment-specific API endpoints for multi-server setups?
4. What's the max payload size for API requests?
